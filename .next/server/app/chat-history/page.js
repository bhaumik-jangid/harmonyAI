(()=>{var e={};e.id=648,e.ids=[648],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3971:(e,t,s)=>{"use strict";s.d(t,{A:()=>k});var r=s(60687),a=s(43210),o=s(85814),n=s.n(o),i=s(33172),l=s(11860),d=s(49384),c=s(82348);function u(...e){return(0,c.QP)((0,d.$)(e))}function h({...e}){return(0,r.jsx)(i.bL,{"data-slot":"dialog",...e})}function p({...e}){return(0,r.jsx)(i.ZL,{"data-slot":"dialog-portal",...e})}function x({className:e,...t}){return(0,r.jsx)(i.hJ,{"data-slot":"dialog-overlay",className:u("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function m({className:e,children:t,...s}){return(0,r.jsxs)(p,{"data-slot":"dialog-portal",children:[(0,r.jsx)(x,{}),(0,r.jsxs)(i.UC,{"data-slot":"dialog-content",className:u("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,(0,r.jsxs)(i.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(l.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f({className:e,...t}){return(0,r.jsx)("div",{"data-slot":"dialog-header",className:u("flex flex-col gap-2 text-center sm:text-left",e),...t})}function g({className:e,...t}){return(0,r.jsx)(i.hE,{"data-slot":"dialog-title",className:u("text-lg leading-none font-semibold",e),...t})}var y=s(16189),j=s(71070),v=s(33872),b=s(39916),w=s(86356),N=s(30474);let k=()=>{let[e,t]=(0,a.useState)(!1),[s,o]=(0,a.useState)(null),i=(0,y.useRouter)();(0,a.useEffect)(()=>{let e=(0,j.A)();e&&o({name:e.name||"Guest",email:e.email||"No email available"})},[]);let l=async()=>{try{if(!(await fetch("https://medgurubackend.onrender.com/api/user/logout",{method:"GET",credentials:"include"})).ok)throw Error("Logout request failed");localStorage.removeItem("token"),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",i.push("/")}catch(e){console.error("Logout failed",e)}};return(0,r.jsxs)("nav",{className:"fixed top-0 left-0 right-0 z-10 flex justify-between items-center p-4 text-white bg-gray-900 bg-opacity-40 lg:bg-transparent",children:[(0,r.jsx)("div",{className:"text-2xl font-semibold",children:(0,r.jsx)(n(),{href:"/",children:"HARMONY"})}),(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)(n(),{href:"/chat",children:(0,r.jsx)("span",{title:"New Chat",children:(0,r.jsx)(v.A,{size:28,strokeWidth:1.5,className:"text-white hover:text-green-400 transition"})})}),(0,r.jsx)(n(),{href:"/chat-history",children:(0,r.jsx)("span",{title:"History",children:(0,r.jsx)(b.A,{size:28,strokeWidth:1.5,className:"text-white hover:text-green-400 transition"})})}),(0,r.jsx)("button",{onClick:()=>{t(!e)},className:"focus:outline-none",children:(0,r.jsx)("span",{title:"Profile",children:(0,r.jsx)(w.A,{size:34,strokeWidth:1.5,className:"text-white hover:text-green-400 transition"})})})]}),(0,r.jsx)(h,{open:e,onOpenChange:t,children:(0,r.jsxs)(m,{className:"bg-gray-800 text-white max-w-sm mx-auto rounded-lg shadow-lg",children:[(0,r.jsx)(f,{children:(0,r.jsx)(g,{className:"text-center text-3xl",children:"Profile"})}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-4",children:[(0,r.jsx)(N.default,{src:"/avatar.jpg",alt:"User Avatar",width:120,height:120,className:"rounded-full border border-gray-500"}),(0,r.jsx)("p",{className:"mt-2 font-semibold",children:s?.name||"Loading..."}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:s?.email||"Loading..."}),(0,r.jsx)("button",{onClick:l,className:"mt-4 w-full bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Logout"})]})]})})]})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20388:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var r=s(65239),a=s(48088),o=s(88170),n=s.n(o),i=s(30893),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let d={children:["",{children:["chat-history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,25048)),"C:\\Users\\bhaum\\Desktop\\projects\\harmony-ai\\src\\app\\chat-history\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"C:\\Users\\bhaum\\Desktop\\projects\\harmony-ai\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\bhaum\\Desktop\\projects\\harmony-ai\\src\\app\\chat-history\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/chat-history/page",pathname:"/chat-history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},25048:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\bhaum\\\\Desktop\\\\projects\\\\harmony-ai\\\\src\\\\app\\\\chat-history\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\bhaum\\Desktop\\projects\\harmony-ai\\src\\app\\chat-history\\page.tsx","default")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},53749:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(60687),a=s(43210),o=s(3971),n=s(16189),i=s(37590);let l=e=>{if(!e)return"Invalid Date";let t=new Date(e);return isNaN(t.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{dateStyle:"medium",timeStyle:"short"}).format(t)},d=({utc:e,userid:t,sessionid:s,userPrompt:o,aiResponse:d})=>{let c=(0,n.useRouter)(),[u,h]=(0,a.useState)(!1),p=async e=>{e.stopPropagation(),h(!0);let r=i.Ay.loading("Deleting session...");try{if(!(await fetch(`https://medgurubackend.onrender.com/api/chat/history/${t}/${s}`,{method:"DELETE"})).ok)throw Error("Failed to delete session");i.Ay.success("Session deleted successfully!",{id:r})}catch(e){console.error("Error deleting session:",e),i.Ay.error("Failed to delete session",{id:r})}finally{h(!1)}};return(0,r.jsxs)("div",{className:"p-4 bg-gray-700 text-white rounded-lg cursor-pointer hover:bg-gray-600 transition-transform transform duration-300 ease-in-out active:scale-95 max-w-[60vw] mx-auto shadow-lg flex justify-between items-center",onClick:()=>c.push(`/chat/${s}`),children:[(0,r.jsxs)("div",{className:"flex flex-col w-full",children:[(0,r.jsx)("p",{className:"text-xs text-gray-400",children:l(e)}),(0,r.jsx)("p",{className:"font-bold truncate",children:o}),(0,r.jsx)("p",{className:"text-gray-300 line-clamp-2",children:d})]}),(0,r.jsx)("button",{onClick:p,className:"hidden lg:flex items-center justify-center text-gray-400 hover:text-red-500 transition-colors ml-4 p-2 rounded-full focus:outline-none",disabled:u,children:u?"⏳":"\uD83D\uDDD1️"})]})};var c=s(71070);let u=()=>{let[e,t]=(0,a.useState)({today:[],yesterday:[],last7Days:[],older:[]}),[s,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,c.A)();if(!e||!e.id){console.error("Invalid token payload");return}let s=await fetch(`https://medgurubackend.onrender.com/api/chat/history/${e.id}`),r=await s.json();t({today:r.history.today||[],yesterday:r.history.yesterday||[],last7Days:r.history.last7Days||[],older:r.older||[]})}catch(e){console.error("Error fetching chat history:",e)}finally{n(!1)}})()},[]),(0,r.jsxs)("div",{className:"flex flex-col h-auto min-h-[100vh] bg-gray-900 text-white pt-[60px]",children:[(0,r.jsx)(o.A,{}),(0,r.jsx)("div",{className:"flex flex-1 items-center justify-center px-6 sm:px-10 py-10",children:(0,r.jsxs)("div",{className:"w-full max-w-4xl space-y-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Chat History"}),s?(0,r.jsx)("p",{className:"text-gray-400 text-center",children:"Loading chat history..."}):(0,r.jsxs)(r.Fragment,{children:[["today","yesterday","last7Days","older"].map(t=>e[t].length>0&&(0,r.jsxs)("div",{className:"bg-gray-800 p-5 rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-300 capitalize mb-3",children:t.replace("last7Days","Last 7 Days").replace("older","Older")}),(0,r.jsx)("div",{className:"space-y-4",children:e[t].map(e=>(0,r.jsx)(d,{sessionid:e.sessionId,utc:e.createdAt,userid:e.userId,userPrompt:e.messages[0]?.text||"No messages",aiResponse:e.messages[1]?.text||"No response"},e._id))})]},t)),Object.values(e).every(e=>0===e.length)&&(0,r.jsx)("p",{className:"text-gray-400 text-center",children:"No chat history available."})]})]})})]})}},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},71070:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(15659),a=s(79119),o=s.n(a);function n(){try{let e=r.A.get("token");if(!e)return console.error("No token found in cookies"),null;let t=o().decode(e);if(!t||"string"==typeof t)return console.error("Invalid token payload"),null;return t}catch(e){return console.error("Error decoding JWT:",e),null}}},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},88986:(e,t,s)=>{Promise.resolve().then(s.bind(s,53749))},99602:(e,t,s)=>{Promise.resolve().then(s.bind(s,25048))}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,145,658,814,39,383],()=>s(20388));module.exports=r})();