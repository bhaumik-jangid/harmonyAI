{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["// import { NextRequest, NextResponse } from \"next/server\";\r\n\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport function middleware(request: NextRequest) {\r\n  const token = request.cookies.get(\"token\")?.value || \"\";\r\n\r\n  const protectedRoutes = [\"/chat\", \"/chat-history\"];\r\n  const authRoutes = [\"/signin\"];\r\n\r\n  const isProtectedRoute = protectedRoutes.some(route =>\r\n    request.nextUrl.pathname.startsWith(route)\r\n  );\r\n\r\n  const isAuthRoute = authRoutes.includes(request.nextUrl.pathname);\r\n\r\n  if (!token) {\r\n    // If user is NOT logged in and trying to access protected routes -> Redirect to /signin\r\n    if (isProtectedRoute) {\r\n      return NextResponse.redirect(new URL(\"/signin\", request.url));\r\n    }\r\n    return NextResponse.next();\r\n  }\r\n\r\n  try {\r\n    // Verify token\r\n    // jwt.verify(token, process.env.JWT_SECRET as string);\r\n\r\n    // If logged-in user tries to access /signin -> Redirect to /chat\r\n    if (isAuthRoute) {\r\n      return NextResponse.redirect(new URL(\"/chat\", request.url));\r\n    }\r\n\r\n    return NextResponse.next();\r\n  } catch {\r\n    // Invalid token -> Redirect to /signin and remove cookie\r\n    const response = NextResponse.redirect(new URL(\"/signin\", request.url));\r\n    response.cookies.delete(\"token\"); // Remove invalid token\r\n    return response;\r\n  }\r\n}\r\n\r\nexport const config = {\r\n    matcher: [\"/chat\", \"/chat/:path*\", \"/chat-history\", \"/signin\"],\r\n  };"],"names":[],"mappings":"AAAA,2DAA2D;;;;;AAE3D;AAAA;;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU,SAAS;IAErD,MAAM,kBAAkB;QAAC;QAAS;KAAgB;IAClD,MAAM,aAAa;QAAC;KAAU;IAE9B,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAA,QAC5C,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAGtC,MAAM,cAAc,WAAW,QAAQ,CAAC,QAAQ,OAAO,CAAC,QAAQ;IAEhE,IAAI,CAAC,OAAO;QACV,wFAAwF;QACxF,IAAI,kBAAkB;YACpB,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,QAAQ,GAAG;QAC7D;QACA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,IAAI;QACF,eAAe;QACf,uDAAuD;QAEvD,iEAAiE;QACjE,IAAI,aAAa;YACf,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,SAAS,QAAQ,GAAG;QAC3D;QAEA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B,EAAE,OAAM;QACN,yDAAyD;QACzD,MAAM,WAAW,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,QAAQ,GAAG;QACrE,SAAS,OAAO,CAAC,MAAM,CAAC,UAAU,uBAAuB;QACzD,OAAO;IACT;AACF;AAEO,MAAM,SAAS;IAClB,SAAS;QAAC;QAAS;QAAgB;QAAiB;KAAU;AAChE"}}]
}