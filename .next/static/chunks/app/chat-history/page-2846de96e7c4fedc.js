(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[648],{1547:(e,t,a)=>{"use strict";a.d(t,{A:()=>k});var s=a(5155),r=a(2115),l=a(6874),n=a.n(l),o=a(1700),i=a(4416),d=a(2596),c=a(9688);function u(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,c.QP)((0,d.$)(t))}function h(e){let{...t}=e;return(0,s.jsx)(o.bL,{"data-slot":"dialog",...t})}function x(e){let{...t}=e;return(0,s.jsx)(o.ZL,{"data-slot":"dialog-portal",...t})}function m(e){let{className:t,...a}=e;return(0,s.jsx)(o.hJ,{"data-slot":"dialog-overlay",className:u("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function g(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(x,{"data-slot":"dialog-portal",children:[(0,s.jsx)(m,{}),(0,s.jsxs)(o.UC,{"data-slot":"dialog-content",className:u("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[a,(0,s.jsxs)(o.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:u("flex flex-col gap-2 text-center sm:text-left",t),...a})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(o.hE,{"data-slot":"dialog-title",className:u("text-lg leading-none font-semibold",t),...a})}var y=a(5695),j=a(3852),v=a(1366),N=a(9676),b=a(9772),w=a(6766);let k=()=>{let[e,t]=(0,r.useState)(!1),[a,l]=(0,r.useState)(null),o=(0,y.useRouter)();(0,r.useEffect)(()=>{let e=(0,j.A)();e&&l({name:e.name||"Guest",email:e.email||"No email available"})},[]);let i=async()=>{try{if(!(await fetch("https://medgurubackend.onrender.com/api/user/logout",{method:"GET",credentials:"include"})).ok)throw Error("Logout request failed");localStorage.removeItem("token"),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",o.push("/")}catch(e){console.error("Logout failed",e)}};return(0,s.jsxs)("nav",{className:"fixed top-0 left-0 right-0 z-10 flex justify-between items-center p-4 text-white bg-gray-900 bg-opacity-40 lg:bg-transparent",children:[(0,s.jsx)("div",{className:"text-2xl font-semibold",children:(0,s.jsx)(n(),{href:"/",children:"HARMONY"})}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsx)(n(),{href:"/chat",children:(0,s.jsx)("span",{title:"New Chat",children:(0,s.jsx)(v.A,{size:28,strokeWidth:1.5,className:"text-white hover:text-green-400 transition"})})}),(0,s.jsx)(n(),{href:"/chat-history",children:(0,s.jsx)("span",{title:"History",children:(0,s.jsx)(N.A,{size:28,strokeWidth:1.5,className:"text-white hover:text-green-400 transition"})})}),(0,s.jsx)("button",{onClick:()=>{t(!e)},className:"focus:outline-none",children:(0,s.jsx)("span",{title:"Profile",children:(0,s.jsx)(b.A,{size:34,strokeWidth:1.5,className:"text-white hover:text-green-400 transition"})})})]}),(0,s.jsx)(h,{open:e,onOpenChange:t,children:(0,s.jsxs)(g,{className:"bg-gray-800 text-white max-w-sm mx-auto rounded-lg shadow-lg",children:[(0,s.jsx)(f,{children:(0,s.jsx)(p,{className:"text-center text-3xl",children:"Profile"})}),(0,s.jsxs)("div",{className:"flex flex-col items-center p-4",children:[(0,s.jsx)(w.default,{src:"/avatar.jpg",alt:"User Avatar",width:120,height:120,className:"rounded-full border border-gray-500"}),(0,s.jsx)("p",{className:"mt-2 font-semibold",children:(null==a?void 0:a.name)||"Loading..."}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:(null==a?void 0:a.email)||"Loading..."}),(0,s.jsx)("button",{onClick:i,className:"mt-4 w-full bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Logout"})]})]})})]})}},3852:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(7383),r=a(8801),l=a.n(r);function n(){try{let e=s.A.get("token");if(!e)return console.error("No token found in cookies"),null;let t=l().decode(e);if(!t||"string"==typeof t)return console.error("Invalid token payload"),null;return t}catch(e){return console.error("Error decoding JWT:",e),null}}},8974:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(5155),r=a(2115),l=a(1547),n=a(5695),o=a(3568);let i=e=>{if(!e)return"Invalid Date";let t=new Date(e);return isNaN(t.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{dateStyle:"medium",timeStyle:"short"}).format(t)},d=e=>{let{utc:t,userid:a,sessionid:l,userPrompt:d,aiResponse:c}=e,u=(0,n.useRouter)(),[h,x]=(0,r.useState)(!1),m=async e=>{e.stopPropagation(),x(!0);let t=o.Ay.loading("Deleting session...");try{if(!(await fetch("https://medgurubackend.onrender.com/api/chat/history/".concat(a,"/").concat(l),{method:"DELETE"})).ok)throw Error("Failed to delete session");o.Ay.success("Session deleted successfully!",{id:t})}catch(e){console.error("Error deleting session:",e),o.Ay.error("Failed to delete session",{id:t})}finally{x(!1)}};return(0,s.jsxs)("div",{className:"p-4 bg-gray-700 text-white rounded-lg cursor-pointer hover:bg-gray-600 transition-transform transform duration-300 ease-in-out active:scale-95 max-w-[60vw] mx-auto shadow-lg flex justify-between items-center",onClick:()=>u.push("/chat/".concat(l)),children:[(0,s.jsxs)("div",{className:"flex flex-col w-full",children:[(0,s.jsx)("p",{className:"text-xs text-gray-400",children:i(t)}),(0,s.jsx)("p",{className:"font-bold truncate",children:d}),(0,s.jsx)("p",{className:"text-gray-300 line-clamp-2",children:c})]}),(0,s.jsx)("button",{onClick:m,className:"hidden lg:flex items-center justify-center text-gray-400 hover:text-red-500 transition-colors ml-4 p-2 rounded-full focus:outline-none",disabled:h,children:h?"⏳":"\uD83D\uDDD1️"})]})};var c=a(3852);let u=()=>{let[e,t]=(0,r.useState)({today:[],yesterday:[],last7Days:[],older:[]}),[a,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,c.A)();if(!e||!e.id){console.error("Invalid token payload");return}let a=await fetch("https://medgurubackend.onrender.com/api/chat/history/".concat(e.id)),s=await a.json();t({today:s.history.today||[],yesterday:s.history.yesterday||[],last7Days:s.history.last7Days||[],older:s.older||[]})}catch(e){console.error("Error fetching chat history:",e)}finally{n(!1)}})()},[]),(0,s.jsxs)("div",{className:"flex flex-col h-auto min-h-[100vh] bg-gray-900 text-white pt-[60px]",children:[(0,s.jsx)(l.A,{}),(0,s.jsx)("div",{className:"flex flex-1 items-center justify-center px-6 sm:px-10 py-10",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl space-y-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Chat History"}),a?(0,s.jsx)("p",{className:"text-gray-400 text-center",children:"Loading chat history..."}):(0,s.jsxs)(s.Fragment,{children:[["today","yesterday","last7Days","older"].map(t=>e[t].length>0&&(0,s.jsxs)("div",{className:"bg-gray-800 p-5 rounded-lg shadow-md",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-300 capitalize mb-3",children:t.replace("last7Days","Last 7 Days").replace("older","Older")}),(0,s.jsx)("div",{className:"space-y-4",children:e[t].map(e=>{var t,a;return(0,s.jsx)(d,{sessionid:e.sessionId,utc:e.createdAt,userid:e.userId,userPrompt:(null===(t=e.messages[0])||void 0===t?void 0:t.text)||"No messages",aiResponse:(null===(a=e.messages[1])||void 0===a?void 0:a.text)||"No response"},e._id)})})]},t)),Object.values(e).every(e=>0===e.length)&&(0,s.jsx)("p",{className:"text-gray-400 text-center",children:"No chat history available."})]})]})})]})}},9990:(e,t,a)=>{Promise.resolve().then(a.bind(a,8974))}},e=>{var t=t=>e(e.s=t);e.O(0,[268,92,874,86,568,441,684,358],()=>t(9990)),_N_E=e.O()}]);